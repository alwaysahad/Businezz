import{j as e}from"./react-query-BSlkKaxv.js";import{b as C,r as h,L as E}from"./react-vendor-DCAT8MD5.js";import{i as I,u as P}from"./index-B81uAijn.js";import{a as T}from"./database-BiwIQAmA.js";import{e as c}from"./helpers-nstW7FaL.js";import{V as w,A as U,H as A,Q as b,C as N}from"./ui-libs-x-WnpP75.js";import"./supabase-DfwcnzK-.js";const p={INVOICES:"invoiceflow_invoices",BUSINESS:"invoiceflow_business",SETTINGS:"invoiceflow_settings",CUSTOMERS:"invoiceflow_customers",PRODUCTS:"invoiceflow_products"},D=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i,d=a=>D.test(a),g=a=>{try{const i=localStorage.getItem(a);return i?JSON.parse(i):null}catch(i){return console.error(`Error reading from storage: ${a}`,i),null}};async function O(){if(!I)return{success:!1,message:"Cloud sync not configured."};const a=g(p.INVOICES)||[],i=g(p.CUSTOMERS)||[],o=g(p.PRODUCTS)||[],r=g(p.BUSINESS),t=g(p.SETTINGS);if(!(a.length>0||i.length>0||o.length>0||!!r))return{success:!0,message:"No local data to migrate."};const m=a.map(s=>({...s,id:d(s.id)?s.id:c(),items:s.items.map(x=>({...x,id:d(x.id)?x.id:c()}))})),j=i.map(s=>({...s,id:d(s.id)?s.id:c()})),f=o.map(s=>({...s,id:d(s.id)?s.id:c()}));let n=r;r&&(!r.id||!d(r.id))&&(n={...r,id:c()});let u=t;return t&&(!t.id||!d(t.id))&&(u={...t,id:c()}),T({invoices:m,customers:j,products:f,business:n||{},settings:u||{}})}function G(){const a=C(),{signUp:i}=P(),[o,r]=h.useState(""),[t,y]=h.useState(""),[m,j]=h.useState(""),[f,n]=h.useState(""),[u,s]=h.useState(!1),x=async l=>{if(l.preventDefault(),n(""),t.length<6){n("Password must be at least 6 characters long");return}if(t!==m){n("Passwords do not match");return}s(!0);try{const{error:v}=await i(o,t);if(v)n(v.message);else{try{await O()}catch(S){console.error("Failed to sync local data:",S)}a("/dashboard")}}catch{n("An unexpected error occurred")}finally{s(!1)}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-midnight-900 via-midnight-800 to-midnight-900 flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-2xl bg-gradient-to-br from-purple-500 to-pink-500 mb-4",children:e.jsx(w,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-3xl font-display font-bold text-white mb-2",children:"Create Account"}),e.jsx("p",{className:"text-midnight-400",children:"Start managing your invoices across all devices"})]}),e.jsxs("div",{className:"glass rounded-2xl p-8",children:[e.jsxs("form",{onSubmit:x,className:"space-y-6",children:[f&&e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-coral-500/20 border border-coral-500/30 rounded-xl text-coral-400",children:[e.jsx(U,{className:"w-5 h-5 flex-shrink-0"}),e.jsx("p",{className:"text-sm",children:f})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx(A,{className:`absolute left-3.5 top-1/2 -translate-y-1/2 w-5 h-5 text-midnight-500 pointer-events-none transition-opacity duration-200 ${o?"opacity-0":"opacity-100"}`}),e.jsx("input",{type:"email",value:o,onChange:l=>r(l.target.value),className:"input-field pl-11",placeholder:"",required:!0,autoComplete:"email"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(b,{className:`absolute left-3.5 top-1/2 -translate-y-1/2 w-5 h-5 text-midnight-500 pointer-events-none transition-opacity duration-200 ${t?"opacity-0":"opacity-100"}`}),e.jsx("input",{type:"password",value:t,onChange:l=>y(l.target.value),className:"input-field pl-11",placeholder:"",required:!0,autoComplete:"new-password",minLength:6})]}),e.jsx("p",{className:"text-midnight-500 text-xs mt-1",children:"At least 6 characters"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Confirm Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(b,{className:`absolute left-3.5 top-1/2 -translate-y-1/2 w-5 h-5 text-midnight-500 pointer-events-none transition-opacity duration-200 ${m?"opacity-0":"opacity-100"}`}),e.jsx("input",{type:"password",value:m,onChange:l=>j(l.target.value),className:"input-field pl-11",placeholder:"",required:!0,autoComplete:"new-password"})]})]}),e.jsxs("div",{className:"bg-midnight-800/50 rounded-xl p-4 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-midnight-300",children:[e.jsx(N,{className:"w-4 h-4 text-teal-400"}),e.jsx("span",{children:"Sync across all your devices"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-midnight-300",children:[e.jsx(N,{className:"w-4 h-4 text-teal-400"}),e.jsx("span",{children:"Secure cloud backup"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-midnight-300",children:[e.jsx(N,{className:"w-4 h-4 text-teal-400"}),e.jsx("span",{children:"Access from anywhere"})]})]}),e.jsx("button",{type:"submit",disabled:u,className:"btn-primary w-full flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:u?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Creating account..."]}):e.jsxs(e.Fragment,{children:[e.jsx(w,{className:"w-5 h-5"}),"Create Account"]})})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("div",{className:"text-midnight-400 text-sm",children:["Already have an account?"," ",e.jsx(E,{to:"/login",className:"text-teal-400 hover:text-teal-300 transition-colors font-medium",children:"Sign in"})]})})]}),e.jsx("p",{className:"text-center text-midnight-500 text-sm mt-8",children:"By signing up, you agree to our Terms of Service and Privacy Policy"})]})})}export{G as default};
