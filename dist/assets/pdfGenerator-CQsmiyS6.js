import{v as B}from"./ui-libs-B_77BvNz.js";import{c as O,d as E,n as H}from"./helpers-C0Vzrg-0.js";const h=(a,o="Rs.")=>{const c=parseFloat(String(a))||0;return`${o==="â‚¹"?"Rs.":o} ${c.toFixed(2)}`},I=(a,o,c,t=15)=>{const l=a.internal.pageSize.getHeight();return o+c>l-20?(a.addPage(),t):o},z=(a,o,c={})=>{const t=new B,l=t.internal.pageSize.getWidth(),n=15,b=l-2*n;let e=15;const F=O(a.items,a.taxRate,a.discount),g=o.currency||"Rs.";t.setFontSize(14),t.setFont("helvetica","bold"),t.text("Tax Invoice",l/2,e,{align:"center"}),e+=10,t.setLineWidth(.5),t.line(n,e,l-n,e),e+=8;const v=e;if(c.showLogo&&o.logo)try{console.log("Adding logo to PDF:",{showLogo:c.showLogo,hasLogo:!!o.logo}),t.addImage(o.logo,"PNG",n,e,20,20)}catch(r){console.error("Error adding logo to PDF:",r)}else console.log("Logo not added to PDF:",{showLogo:c.showLogo,hasLogo:!!o.logo});t.setFontSize(12),t.setFont("helvetica","bold");const R=e+5;if(t.text(o.name||"Business Name",l-n,R,{align:"right"}),e+=8,t.setFontSize(8),t.setFont("helvetica","normal"),o.address&&(t.text(o.address,l-n,e,{align:"right"}),e+=4),o.city||o.state){const r=`${o.city||""}${o.city&&o.state?", ":""}${o.state||""} ${o.pincode||""}`.trim();t.text(r,l-n,e,{align:"right"}),e+=4}o.phone&&(t.text(`Phone no.: ${o.phone}`,l-n,e,{align:"right"}),e+=4),o.email&&(t.text(`Email: ${o.email}`,l-n,e,{align:"right"}),e+=4),o.taxId&&(t.text(`GSTIN: ${o.taxId}, State: ${o.state||"09-Uttar Pradesh"}`,l-n,e,{align:"right"}),e+=4),e=Math.max(e,v+30),e+=5,t.setLineWidth(.5),t.line(n,e,l-n,e),e+=8;const i=n,d=l/2+5,p=e;t.setFont("helvetica","bold"),t.setFontSize(9),t.text("Bill To",i,p),t.setFont("helvetica","normal"),t.setFontSize(8);let u=p+5;if(t.text(a.customerName||"Customer",i,u),u+=4,a.customerAddress){const r=t.splitTextToSize(a.customerAddress,l/2-n-10);t.text(r,i,u),u+=r.length*4}t.text(`State: ${o.state||"09-Uttar Pradesh"}`,i,u),t.setFont("helvetica","bold"),t.setFontSize(9),t.text("Invoice Details",d,p),t.setFont("helvetica","normal"),t.setFontSize(8);let f=p+5;t.text(`Invoice No.: ${a.invoiceNumber}`,d,f),f+=4,t.text(`Date: ${E(a.date)}`,d,f),f+=4,t.text(`Place of Supply: ${o.state||"09-Uttar Pradesh"}`,d,f),e=Math.max(u,f)+8,t.setLineWidth(.5),t.line(n,e,l-n,e),e+=5;const Y=a.items.map((r,G)=>{const L=r.quantity*r.price,A=L*a.discount/100,$=L-A,D=$*a.taxRate/100,M=$+D;return[(G+1).toString(),r.name,r.quantity.toString(),r.unit||"PCS",h(r.price,g),`${h(A,g)}
(${a.discount}%)`,h($,g),`${h(D,g)}
(${a.taxRate.toFixed(1)}%)`,h(M,g)]});t.autoTable({startY:e,head:[["#","Item name","Quantity","Unit","Price/Unit","Discount","Taxable amount","GST","Amount"]],body:Y,margin:{left:n,right:n},tableWidth:b,styles:{fontSize:7,cellPadding:2,lineColor:[0,0,0],lineWidth:.1,textColor:[0,0,0]},headStyles:{fillColor:[255,255,255],textColor:[0,0,0],fontStyle:"bold",lineWidth:.3},bodyStyles:{fillColor:[255,255,255]},columnStyles:{0:{cellWidth:10,halign:"center"},1:{cellWidth:"auto"},2:{cellWidth:15,halign:"center"},3:{cellWidth:12,halign:"center"},4:{cellWidth:20,halign:"right"},5:{cellWidth:20,halign:"right"},6:{cellWidth:22,halign:"right"},7:{cellWidth:20,halign:"right"},8:{cellWidth:22,halign:"right"}}}),e=t.lastAutoTable.finalY+5,e=I(t,e,50,n),t.setLineWidth(.5),t.line(n,e,l-n,e),e+=8;const S=e;t.setFont("helvetica","bold"),t.setFontSize(8),t.text("Tax type",i,S),t.text("Taxable amount",i+35,S,{align:"right"}),t.text("Rate",i+50,S,{align:"center"}),t.text("Tax amount",i+70,S,{align:"right"}),t.setFont("helvetica","normal"),t.setFontSize(7);let s=S+5;const W=a.taxRate/2,P=F.taxAmount/2;t.text("SGST",i,s),t.text(h(F.taxableAmount,g),i+35,s,{align:"right"}),t.text(`${W.toFixed(1)}%`,i+50,s,{align:"center"}),t.text(h(P,g),i+70,s,{align:"right"}),s+=5,t.text("CGST",i,s),t.text(h(F.taxableAmount,g),i+35,s,{align:"right"}),t.text(`${W.toFixed(1)}%`,i+50,s,{align:"center"}),t.text(h(P,g),i+70,s,{align:"right"}),t.setFont("helvetica","bold"),t.setFontSize(8),t.text("Amounts",d,S),t.setFont("helvetica","normal"),t.setFontSize(7);let m=S+5;t.text("Sub Total",d,m),t.text(h(F.taxableAmount,g),l-n,m,{align:"right"}),m+=5,t.text("Round off",d,m);const w=`${F.roundOff>=0?"":"- "}${h(Math.abs(F.roundOff),g)}`;t.text(w,l-n,m,{align:"right"}),m+=5,t.setFont("helvetica","bold"),t.setFontSize(8),t.text("Total",d,m),t.text(h(F.total,g),l-n,m,{align:"right"}),e=Math.max(s,m)+8,t.setLineWidth(.5),t.line(n,e,l-n,e),e+=8;const C=`${H(Math.floor(F.total))} Rupees only`,T=t.splitTextToSize(C,l/2-n-10),y=a.notes?t.splitTextToSize(a.notes,l/2-n-10):[],N=15+T.length*4+10+y.length*4+35;e=I(t,e,N,n);const U=e;t.setFont("helvetica","bold"),t.setFontSize(8),t.text("Invoice Amount In Words",i,e),e+=5,t.setFont("helvetica","normal"),t.setFontSize(7),t.text(T,i,e),e+=T.length*4+5,t.setFont("helvetica","bold"),t.setFontSize(8),t.text("Terms and conditions",i,e),e+=5,t.setFont("helvetica","normal"),t.setFontSize(7),a.notes&&(e+=2,t.text(y,i,e),e+=y.length*4);let x=U;if(t.setFont("helvetica","normal"),t.setFontSize(7),t.text(`For: ${o.name||"Your Business Name"}`,d,x),x+=10,o.signature)try{console.log("Adding signature to PDF:",{hasSignature:!!o.signature}),t.addImage(o.signature,"PNG",d+15,x,30,15),x+=20}catch(r){console.error("Failed to add signature to PDF:",r),x+=15}else console.log("Signature not added to PDF:",{hasSignature:!!o.signature}),x+=15;return t.setLineWidth(.3),t.line(d+10,x,d+50,x),x+=4,t.setFont("helvetica","bold"),t.text("Authorized Signatory",d+30,x,{align:"center"}),t},X=(a,o,c)=>{z(a,o,c).save(`${a.invoiceNumber}.pdf`)},j=(a,o,c)=>z(a,o,c).output("blob"),Q=(a,o,c)=>{const l=z(a,o,c).output("blob"),n=URL.createObjectURL(l);window.open(n,"_blank")};export{X as d,j as g,Q as o};
