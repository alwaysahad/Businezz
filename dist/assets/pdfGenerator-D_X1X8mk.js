import{v as G}from"./ui-libs-B_77BvNz.js";import{c as B,d as M,n as O}from"./helpers-C0Vzrg-0.js";const d=(a,o="Rs.")=>{const g=parseFloat(String(a))||0;return`${o==="â‚¹"?"Rs.":o} ${g.toFixed(2)}`},$=(a,o,g={})=>{const t=new G,l=t.internal.pageSize.getWidth(),T=t.internal.pageSize.getHeight(),n=15,A=l-2*n;let e=15;const m=B(a.items,a.taxRate,a.discount),s=o.currency||"Rs.";t.setFontSize(14),t.setFont("helvetica","bold"),t.text("Tax Invoice",l/2,e,{align:"center"}),e+=10,t.setLineWidth(.5),t.line(n,e,l-n,e),e+=8;const D=e;if(g.showLogo&&o.logo)try{t.addImage(o.logo,"PNG",n,e,20,20)}catch(r){console.error("Error adding logo to PDF:",r)}t.setFontSize(12),t.setFont("helvetica","bold");const L=e+5;if(t.text(o.name||"Business Name",l-n,L,{align:"right"}),e+=8,t.setFontSize(8),t.setFont("helvetica","normal"),o.address&&(t.text(o.address,l-n,e,{align:"right"}),e+=4),o.city||o.state){const r=`${o.city||""}${o.city&&o.state?", ":""}${o.state||""} ${o.pincode||""}`.trim();t.text(r,l-n,e,{align:"right"}),e+=4}o.phone&&(t.text(`Phone no.: ${o.phone}`,l-n,e,{align:"right"}),e+=4),o.email&&(t.text(`Email: ${o.email}`,l-n,e,{align:"right"}),e+=4),o.taxId&&(t.text(`GSTIN: ${o.taxId}, State: ${o.state||"09-Uttar Pradesh"}`,l-n,e,{align:"right"}),e+=4),e=Math.max(e,D+30),e+=5,t.setLineWidth(.5),t.line(n,e,l-n,e),e+=8;const i=n,c=l/2+5,p=e;t.setFont("helvetica","bold"),t.setFontSize(9),t.text("Bill To",i,p),t.setFont("helvetica","normal"),t.setFontSize(8);let u=p+5;if(t.text(a.customerName||"Customer",i,u),u+=4,a.customerAddress){const r=t.splitTextToSize(a.customerAddress,l/2-n-10);t.text(r,i,u),u+=r.length*4}t.text(`State: ${o.state||"09-Uttar Pradesh"}`,i,u),t.setFont("helvetica","bold"),t.setFontSize(9),t.text("Invoice Details",c,p),t.setFont("helvetica","normal"),t.setFontSize(8);let f=p+5;t.text(`Invoice No.: ${a.invoiceNumber}`,c,f),f+=4,t.text(`Date: ${M(a.date)}`,c,f),f+=4,t.text(`Place of Supply: ${o.state||"09-Uttar Pradesh"}`,c,f),e=Math.max(u,f)+8,t.setLineWidth(.5),t.line(n,e,l-n,e),e+=5;const R=a.items.map((r,U)=>{const I=r.quantity*r.price,P=I*a.discount/100,y=I-P,v=y*a.taxRate/100,w=y+v;return[(U+1).toString(),r.name,r.quantity.toString(),r.unit||"PCS",d(r.price,s),`${d(P,s)}
(${a.discount}%)`,d(y,s),`${d(v,s)}
(${a.taxRate.toFixed(1)}%)`,d(w,s)]});t.autoTable({startY:e,head:[["#","Item name","Quantity","Unit","Price/Unit","Discount","Taxable amount","GST","Amount"]],body:R,margin:{left:n,right:n},tableWidth:A,styles:{fontSize:7,cellPadding:2,lineColor:[0,0,0],lineWidth:.1,textColor:[0,0,0]},headStyles:{fillColor:[255,255,255],textColor:[0,0,0],fontStyle:"bold",lineWidth:.3},bodyStyles:{fillColor:[255,255,255]},columnStyles:{0:{cellWidth:10,halign:"center"},1:{cellWidth:"auto"},2:{cellWidth:15,halign:"center"},3:{cellWidth:12,halign:"center"},4:{cellWidth:20,halign:"right"},5:{cellWidth:20,halign:"right"},6:{cellWidth:22,halign:"right"},7:{cellWidth:20,halign:"right"},8:{cellWidth:22,halign:"right"}}}),e=t.lastAutoTable.finalY+5,t.setLineWidth(.5),t.line(n,e,l-n,e),e+=8;const S=e;t.setFont("helvetica","bold"),t.setFontSize(8),t.text("Tax type",i,S),t.text("Taxable amount",i+35,S,{align:"right"}),t.text("Rate",i+50,S,{align:"center"}),t.text("Tax amount",i+70,S,{align:"right"}),t.setFont("helvetica","normal"),t.setFontSize(7);let h=S+5;const z=a.taxRate/2,W=m.taxAmount/2;t.text("SGST",i,h),t.text(d(m.taxableAmount,s),i+35,h,{align:"right"}),t.text(`${z.toFixed(1)}%`,i+50,h,{align:"center"}),t.text(d(W,s),i+70,h,{align:"right"}),h+=5,t.text("CGST",i,h),t.text(d(m.taxableAmount,s),i+35,h,{align:"right"}),t.text(`${z.toFixed(1)}%`,i+50,h,{align:"center"}),t.text(d(W,s),i+70,h,{align:"right"}),t.setFont("helvetica","bold"),t.setFontSize(8),t.text("Amounts",c,S),t.setFont("helvetica","normal"),t.setFontSize(7);let x=S+5;t.text("Sub Total",c,x),t.text(d(m.taxableAmount,s),l-n,x,{align:"right"}),x+=5,t.text("Round off",c,x);const Y=`${m.roundOff>=0?"":"- "}${d(Math.abs(m.roundOff),s)}`;t.text(Y,l-n,x,{align:"right"}),x+=5,t.setFont("helvetica","bold"),t.setFontSize(8),t.text("Total",c,x),t.text(d(m.total,s),l-n,x,{align:"right"}),e=Math.max(h,x)+8,t.setLineWidth(.5),t.line(n,e,l-n,e),e+=8;const C=e;t.setFont("helvetica","bold"),t.setFontSize(8),t.text("Invoice Amount In Words",i,e),e+=5,t.setFont("helvetica","normal"),t.setFontSize(7);const N=`${O(Math.floor(m.total))} Rupees only`,b=t.splitTextToSize(N,l/2-n-10);if(t.text(b,i,e),e+=b.length*4+5,t.setFont("helvetica","bold"),t.setFontSize(8),t.text("Terms and conditions",i,e),e+=5,t.setFont("helvetica","normal"),t.setFontSize(7),a.notes){e+=2;const r=t.splitTextToSize(a.notes,l/2-n-10);t.text(r,i,e)}let F=C;if(t.setFont("helvetica","normal"),t.setFontSize(7),t.text(`For: ${o.name||"Your Business Name"}`,c,F),F=T-40,o.signature)try{t.addImage(o.signature,"PNG",c+15,F-10,30,15),F+=10}catch(r){console.error("Failed to add signature to PDF:",r)}return t.setLineWidth(.3),t.line(c+10,F,c+50,F),F+=4,t.setFont("helvetica","bold"),t.text("Authorized Signatory",c+30,F,{align:"center"}),t},H=(a,o,g)=>{$(a,o,g).save(`${a.invoiceNumber}.pdf`)},X=(a,o,g)=>$(a,o,g).output("blob"),j=(a,o,g)=>{const l=$(a,o,g).output("blob"),T=URL.createObjectURL(l);window.open(T,"_blank")};export{H as d,X as g,j as o};
