import{j as e}from"./react-query-BSlkKaxv.js";import{r as i}from"./react-vendor-DCAT8MD5.js";import{f as U,e as $}from"./helpers-nstW7FaL.js";import{e as B,u as Q}from"./useData-CpxXeTce.js";import{h as C,P,o as O,a as R,t as V,u as X,X as G,w as H}from"./ui-libs-x-WnpP75.js";import"./database-DIn5S9pN.js";import"./index-DGIWkH9N.js";import"./supabase-DfwcnzK-.js";const J=["piece","kg","g","liter","ml","dozen","box","pack","unit","hour","service"];function ae(){const{products:m,loading:S,saveProduct:k,deleteProduct:D}=B(),{business:L,loading:E}=Q(),F=S||E,[n,A]=i.useState(""),[I,g]=i.useState(!1),[c,x]=i.useState(null),[N,h]=i.useState(null),[b,v]=i.useState(!1),[u,y]=i.useState(!1),[t,r]=i.useState({name:"",description:"",price:"",unit:"piece"}),[l,d]=i.useState({}),w=m.filter(s=>{var a;return s.name.toLowerCase().includes(n.toLowerCase())||((a=s.description)==null?void 0:a.toLowerCase().includes(n.toLowerCase()))}),p=(s=null)=>{s?(x(s),r({name:s.name,description:s.description||"",price:s.price.toString(),unit:s.unit||"piece"})):(x(null),r({name:"",description:"",price:"",unit:"piece"})),d({}),g(!0)},j=()=>{g(!1),x(null),r({name:"",description:"",price:"",unit:"piece"}),d({})},o=s=>{const{name:a,value:T}=s.target;r(f=>({...f,[a]:T})),l[a]&&d(f=>({...f,[a]:null}))},q=()=>{const s={};return t.name.trim()||(s.name="Product name is required"),(!t.price||parseFloat(t.price)<0)&&(s.price="Valid price is required"),d(s),Object.keys(s).length===0},z=async()=>{if(q()){v(!0);try{const s={id:(c==null?void 0:c.id)||$(),name:t.name.trim(),description:t.description.trim(),price:parseFloat(t.price),unit:t.unit};await k(s),j()}catch(s){console.error("Failed to save product:",s)}finally{v(!1)}}},M=async s=>{y(!0);try{await D(s)}catch(a){console.error("Failed to delete product:",a)}finally{y(!1),h(null)}};return F&&m.length===0?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(C,{className:"w-8 h-8 text-teal-400 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-midnight-400",children:"Loading products..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-display font-bold text-white",children:"Products & Services"}),e.jsxs("p",{className:"text-midnight-400",children:[m.length," items"]})]}),e.jsxs("button",{onClick:()=>p(),className:"btn-primary flex items-center gap-2 self-start",children:[e.jsx(P,{className:"w-5 h-5"}),e.jsx("span",{children:"Add Product"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(O,{className:`absolute left-3.5 top-1/2 -translate-y-1/2 w-5 h-5 text-midnight-400 pointer-events-none transition-opacity duration-200 ${n?"opacity-0":"opacity-100"}`}),e.jsx("input",{type:"text",placeholder:"",value:n,onChange:s=>A(s.target.value),className:"input-field pl-11"})]}),w.length===0?e.jsxs("div",{className:"text-center py-16",children:[e.jsx(R,{className:"w-16 h-16 text-midnight-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:n?"No products found":"No products yet"}),e.jsx("p",{className:"text-midnight-400 mb-6",children:n?"Try adjusting your search":"Add products to quickly add them to invoices"}),!n&&e.jsxs("button",{onClick:()=>p(),className:"btn-primary inline-flex items-center gap-2",children:[e.jsx(P,{className:"w-5 h-5"}),"Add Product"]})]}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:w.map(s=>e.jsx("div",{className:"glass rounded-xl p-5 card-hover animate-fade-in",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg font-semibold text-white truncate",children:s.name}),s.description&&e.jsx("p",{className:"text-midnight-400 text-sm mt-1 line-clamp-2",children:s.description}),e.jsxs("div",{className:"mt-3 flex items-baseline gap-2",children:[e.jsx("span",{className:"text-2xl font-mono font-bold text-teal-400",children:U(s.price,L.currency)}),s.unit&&e.jsxs("span",{className:"text-midnight-400 text-sm",children:["/ ",s.unit]})]})]}),e.jsxs("div",{className:"flex gap-1 ml-2",children:[e.jsx("button",{onClick:()=>p(s),className:"p-2 text-midnight-400 hover:text-white hover:bg-midnight-700 rounded-lg transition-colors",children:e.jsx(V,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>h(s.id),className:"p-2 text-midnight-400 hover:text-coral-400 hover:bg-coral-500/10 rounded-lg transition-colors",children:e.jsx(X,{className:"w-4 h-4"})})]})]})},s.id))}),I&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70",children:e.jsxs("div",{className:"glass rounded-2xl p-6 max-w-md w-full animate-scale-in",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-white",children:c?"Edit Product":"Add Product"}),e.jsx("button",{onClick:j,className:"p-2 hover:bg-midnight-700 rounded-lg transition-colors",children:e.jsx(G,{className:"w-5 h-5 text-midnight-400"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Product Name *"}),e.jsx("input",{type:"text",name:"name",value:t.name,onChange:o,className:`input-field ${l.name?"border-coral-500":""}`,placeholder:"e.g., Notebook, Pen, Cake"}),l.name&&e.jsx("p",{className:"text-coral-400 text-sm mt-1",children:l.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Description"}),e.jsx("textarea",{name:"description",value:t.description,onChange:o,className:"input-field min-h-[80px] resize-none",placeholder:"Brief description of the product"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Price *"}),e.jsx("input",{type:"number",name:"price",min:"0",step:"0.01",value:t.price,onChange:o,className:`input-field ${l.price?"border-coral-500":""}`,placeholder:"0.00"}),l.price&&e.jsx("p",{className:"text-coral-400 text-sm mt-1",children:l.price})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Unit"}),e.jsx("select",{name:"unit",value:t.unit,onChange:o,className:"input-field",children:J.map(s=>e.jsx("option",{value:s,children:s},s))})]})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:j,className:"btn-secondary flex-1",children:"Cancel"}),e.jsxs("button",{onClick:z,disabled:b,className:"btn-primary flex-1 flex items-center justify-center gap-2",children:[b?e.jsx(C,{className:"w-4 h-4 animate-spin"}):e.jsx(H,{className:"w-4 h-4"}),c?"Update":"Add Product"]})]})]})}),N&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70",children:e.jsxs("div",{className:"glass rounded-2xl p-6 max-w-md w-full animate-scale-in",children:[e.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:"Delete Product?"}),e.jsx("p",{className:"text-midnight-400 mb-6",children:"This product will be permanently deleted."}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx("button",{onClick:()=>h(null),className:"btn-secondary",disabled:u,children:"Cancel"}),e.jsx("button",{onClick:()=>M(N),className:"btn-danger",disabled:u,children:u?"Deleting...":"Delete"})]})]})})]})}export{ae as default};
