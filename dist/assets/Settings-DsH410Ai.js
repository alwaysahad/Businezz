import{j as e}from"./react-query-0I5YXCIV.js";import{r as c}from"./react-vendor-GSsPULXx.js";import{u as D,b as A}from"./useData-D3VBIZIu.js";import{f,s as U,r as E,B as G,F as $,p as w,z as y}from"./ui-libs-B_77BvNz.js";import"./database-DTV7DMIG.js";import"./index-C9ltvpI4.js";import"./supabase-DfwcnzK-.js";const M=[{id:"business",label:"Business Profile",icon:G},{id:"invoice",label:"Invoice Settings",icon:$}];function K(){const{business:m,loading:S,saveBusiness:u}=D(),{settings:h,loading:C,saveSettings:B}=A(),[a,r]=c.useState({}),[l,g]=c.useState({});c.useEffect(()=>{m&&Object.keys(m).length>0&&r(m)},[m]),c.useEffect(()=>{h&&Object.keys(h).length>0&&g(h)},[h]);const[b,d]=c.useState(!1),[N,v]=c.useState(!1),[p,L]=c.useState("business"),o=s=>{const{name:t,value:n}=s.target;r(i=>({...i,[t]:n}))},j=s=>{const{name:t,value:n,type:i}=s.target;g(x=>({...x,[t]:i==="number"?parseFloat(n)||0:n}))},I=async()=>{v(!0);try{await Promise.all([u(a),B(l)]),d(!0),setTimeout(()=>d(!1),2e3)}catch(s){console.error("Failed to save settings:",s)}finally{v(!1)}},T=s=>{var n;const t=(n=s.target.files)==null?void 0:n[0];if(t){const i=new FileReader;i.onloadend=()=>{r(x=>({...x,logo:i.result}))},i.readAsDataURL(t)}},P=async()=>{const s={...a,logo:null};r(s);try{await u(s),d(!0),setTimeout(()=>d(!1),2e3)}catch(t){console.error("Failed to remove logo:",t),r(a)}},F=s=>{var n;const t=(n=s.target.files)==null?void 0:n[0];if(t){const i=new FileReader;i.onloadend=()=>{r(x=>({...x,signature:i.result}))},i.readAsDataURL(t)}},R=async()=>{const s={...a,signature:null};r(s);try{await u(s),d(!0),setTimeout(()=>d(!1),2e3)}catch(t){console.error("Failed to remove signature:",t),r(a)}},k=()=>{g(s=>({...s,showLogo:!s.showLogo}))};return S||C?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(f,{className:"w-8 h-8 text-teal-400 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-midnight-400",children:"Loading settings..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-display font-bold text-white",children:"Settings"}),e.jsx("p",{className:"text-midnight-400",children:"Manage your business profile and settings"})]}),e.jsx("button",{onClick:I,disabled:N,className:`btn-primary flex items-center gap-2 self-start transition-all ${b?"bg-teal-600":""}`,children:N?e.jsxs(e.Fragment,{children:[e.jsx(f,{className:"w-5 h-5 animate-spin"}),"Saving..."]}):b?e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"w-5 h-5"}),"Saved!"]}):e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"w-5 h-5"}),"Save Changes"]})})]}),e.jsx("div",{className:"flex flex-wrap gap-2 border-b border-midnight-700 pb-4",children:M.map(s=>{const t=s.icon;return e.jsxs("button",{onClick:()=>L(s.id),className:`flex items-center gap-2 px-4 py-2 rounded-xl transition-colors ${p===s.id?"bg-teal-500/20 text-teal-400":"text-midnight-400 hover:text-white hover:bg-midnight-700"}`,children:[e.jsx(t,{className:"w-5 h-5"}),s.label]},s.id)})}),p==="business"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2 space-y-6",children:e.jsxs("div",{className:"glass rounded-2xl p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Business Information"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Business Name"}),e.jsx("input",{type:"text",name:"name",value:a.name||"",onChange:o,className:"input-field",placeholder:"Your business name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Address"}),e.jsx("textarea",{name:"address",value:a.address||"",onChange:o,className:"input-field min-h-[80px] resize-none",placeholder:"Business address"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"City"}),e.jsx("input",{type:"text",name:"city",value:a.city||"",onChange:o,className:"input-field",placeholder:"City"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"State"}),e.jsx("input",{type:"text",name:"state",value:a.state||"",onChange:o,className:"input-field",placeholder:"State"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"PIN Code"}),e.jsx("input",{type:"text",name:"pincode",value:a.pincode||"",onChange:o,className:"input-field",placeholder:"PIN Code"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Phone Number"}),e.jsx("input",{type:"tel",name:"phone",value:a.phone||"",onChange:o,className:"input-field",placeholder:"Business phone"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Email Address"}),e.jsx("input",{type:"email",name:"email",value:a.email||"",onChange:o,className:"input-field",placeholder:"business@email.com"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Tax ID / Registration Number"}),e.jsx("input",{type:"text",name:"taxId",value:a.taxId||"",onChange:o,className:"input-field font-mono",placeholder:"Tax registration number"})]})]})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"glass rounded-2xl p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Business Logo"}),a.logo?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:a.logo,alt:"Business logo",className:"w-full h-40 object-contain bg-white rounded-xl"}),e.jsx("button",{onClick:P,className:"absolute top-2 right-2 p-2 bg-coral-500 text-white rounded-lg hover:bg-coral-600 transition-colors",children:e.jsx(w,{className:"w-4 h-4"})})]}):e.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-40 border-2 border-dashed border-midnight-600 rounded-xl cursor-pointer hover:border-teal-500/50 transition-colors",children:[e.jsx(y,{className:"w-8 h-8 text-midnight-500 mb-2"}),e.jsx("span",{className:"text-midnight-400 text-sm",children:"Upload logo"}),e.jsx("span",{className:"text-midnight-500 text-xs mt-1",children:"PNG, JPG up to 2MB"}),e.jsx("input",{type:"file",accept:"image/*",onChange:T,className:"hidden"})]})]}),e.jsxs("div",{className:"glass rounded-2xl p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Signature"}),e.jsx("p",{className:"text-midnight-400 text-sm mb-4",children:"Upload your signature to appear on invoices"}),a.signature?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:a.signature,alt:"Signature",className:"w-full h-32 object-contain bg-white rounded-xl"}),e.jsx("button",{onClick:R,className:"absolute top-2 right-2 p-2 bg-coral-500 text-white rounded-lg hover:bg-coral-600 transition-colors",children:e.jsx(w,{className:"w-4 h-4"})})]}):e.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-32 border-2 border-dashed border-midnight-600 rounded-xl cursor-pointer hover:border-teal-500/50 transition-colors",children:[e.jsx(y,{className:"w-8 h-8 text-midnight-500 mb-2"}),e.jsx("span",{className:"text-midnight-400 text-sm",children:"Upload signature"}),e.jsx("span",{className:"text-midnight-500 text-xs mt-1",children:"PNG, JPG up to 2MB"}),e.jsx("input",{type:"file",accept:"image/*",onChange:F,className:"hidden"})]})]})]})]}),p==="invoice"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"glass rounded-2xl p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Invoice Defaults"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Invoice Prefix"}),e.jsx("input",{type:"text",name:"invoicePrefix",value:l.invoicePrefix||"",onChange:j,className:"input-field font-mono",placeholder:"INV"}),e.jsxs("p",{className:"text-midnight-500 text-xs mt-1",children:["Your invoices will be numbered like ",l.invoicePrefix,"-2026-0001"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Default Tax Rate (%)"}),e.jsx("input",{type:"number",name:"taxRate",min:"0",max:"100",value:l.taxRate||0,onChange:j,className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Tax Label"}),e.jsx("input",{type:"text",name:"taxLabel",value:l.taxLabel||"",onChange:j,className:"input-field",placeholder:"e.g., GST, VAT, Tax"})]})]})]}),e.jsxs("div",{className:"glass rounded-2xl p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Invoice Display"}),e.jsxs("label",{className:"flex items-center justify-between p-4 bg-midnight-800/50 rounded-xl cursor-pointer",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:"Show Business Logo"}),e.jsx("p",{className:"text-midnight-400 text-sm",children:"Display your logo on invoices"})]}),e.jsx("div",{className:`w-12 h-7 rounded-full transition-colors ${l.showLogo?"bg-teal-500":"bg-midnight-600"}`,onClick:k,children:e.jsx("div",{className:`w-5 h-5 bg-white rounded-full shadow transform transition-transform mt-1 ${l.showLogo?"translate-x-6":"translate-x-1"}`})})]})]}),e.jsxs("div",{className:"lg:col-span-2 glass rounded-2xl p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Invoice Preview"}),e.jsxs("div",{className:"bg-white rounded-xl p-6 text-gray-900",children:[e.jsxs("div",{className:"flex justify-between items-start border-b border-gray-200 pb-4",children:[e.jsxs("div",{children:[l.showLogo&&a.logo&&e.jsx("img",{src:a.logo,alt:"Logo",className:"h-12 mb-2"}),e.jsx("h3",{className:"font-bold text-lg",children:a.name||"Your Business Name"}),e.jsx("p",{className:"text-gray-500 text-sm",children:a.address||"Business Address"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-gray-400 text-sm uppercase",children:"Invoice"}),e.jsxs("p",{className:"font-mono font-bold",children:[l.invoicePrefix||"INV","-2026-0001"]})]})]}),e.jsx("div",{className:"mt-4 text-sm text-gray-600",children:e.jsxs("p",{children:[l.taxLabel||"Tax"," Rate: ",l.taxRate||0,"%"]})})]})]})]})]})}export{K as default};
