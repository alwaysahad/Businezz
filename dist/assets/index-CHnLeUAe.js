const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-CVwXYNEE.js","assets/react-query-0I5YXCIV.js","assets/react-vendor-GSsPULXx.js","assets/helpers-C0Vzrg-0.js","assets/useData-BNLmJ_s2.js","assets/database-Dl3kmWnY.js","assets/ui-libs-B_77BvNz.js","assets/supabase-DfwcnzK-.js","assets/Invoices-BeKIbdQe.js","assets/pdfGenerator-CQsmiyS6.js","assets/CreateInvoice-Cg_mgIwx.js","assets/ViewInvoice-Br8bLZaP.js","assets/Products-Dapc0xUn.js","assets/Customers-DQuEU88R.js","assets/Settings-BNzqnVbE.js","assets/Login-C1Evzxj6.js","assets/Signup-C3LZPl2e.js","assets/ForgotPassword-Hwfqentl.js"])))=>i.map(i=>d[i]);
var D=Object.defineProperty;var F=(r,s,n)=>s in r?D(r,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):r[s]=n;var S=(r,s,n)=>F(r,typeof s!="symbol"?s+"":s,n);import{j as e,_ as h,Q as U,a as V,R as M}from"./react-query-0I5YXCIV.js";import{a as B,r as t,N as Q,u as J,b as X,L as w,B as $,R as E,d as m,e as q}from"./react-vendor-GSsPULXx.js";import{c as Y}from"./supabase-DfwcnzK-.js";import{R as N,P as W,L as Z,F as G,a as K,U as H,S as ee,C as te,b as I,c as C,d as O,e as se,X as ne,M as ae,f as re,A as ie,g as le}from"./ui-libs-B_77BvNz.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const x of i.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&o(x)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}})();var y={},P=B;y.createRoot=P.createRoot,y.hydrateRoot=P.hydrateRoot;const oe="https://kkcalkiqfdykbmitaqcb.supabase.co",A="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImtrY2Fsa2lxZmR5a2JtaXRhcWNiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk4MjQ1MTksImV4cCI6MjA4NTQwMDUxOX0.hkDQS1mVtO2lgYlQXYNkbNpIF9crkotYMVaxe5gmLkc",g=!!A,d=g?Y(oe,A):null,Le={INVOICES:"invoices",CUSTOMERS:"customers",PRODUCTS:"products",BUSINESS:"business_profile",SETTINGS:"settings"},T=t.createContext(void 0);function ce({children:r}){const[s,n]=t.useState(null),[o,a]=t.useState(null),[i,x]=t.useState(!0);t.useEffect(()=>{if(!d){x(!1);return}d.auth.getSession().then(({data:{session:c}})=>{a(c),n((c==null?void 0:c.user)??null),x(!1)});const{data:{subscription:l}}=d.auth.onAuthStateChange((c,u)=>{a(u),n((u==null?void 0:u.user)??null),x(!1)});return()=>l.unsubscribe()},[]);const b={user:s,session:o,loading:i,signUp:async(l,c)=>{if(!d)return{error:{message:"Supabase not configured"}};const{error:u}=await d.auth.signUp({email:l,password:c});return{error:u}},signIn:async(l,c)=>{if(!d)return{error:{message:"Supabase not configured"}};const{error:u}=await d.auth.signInWithPassword({email:l,password:c});return{error:u}},signOut:async()=>{d&&await d.auth.signOut()},resetPassword:async l=>{if(!d)return{error:{message:"Supabase not configured"}};const{error:c}=await d.auth.resetPasswordForEmail(l,{redirectTo:`${window.location.origin}/reset-password`});return{error:c}}};return e.jsx(T.Provider,{value:b,children:r})}function _(){const r=t.useContext(T);if(r===void 0)throw new Error("useAuth must be used within an AuthProvider");return r}const k=t.createContext(void 0);function de({children:r}){const{user:s}=_(),[n,o]=t.useState(null),[a,i]=t.useState("idle");t.useEffect(()=>{if(!d||!g||!s)return;const p=()=>{console.log("Remote change detected, refreshing data..."),i("syncing"),setTimeout(()=>{o(new Date),i("synced"),setTimeout(()=>i("idle"),2e3)},500)},j=["invoices","customers","products","business_profile","settings"].map(f=>d.channel(`${f}-changes`).on("postgres_changes",{event:"*",schema:"public",table:f,filter:`user_id=eq.${s.id}`},p).subscribe());return()=>{j.forEach(f=>f.unsubscribe())}},[s]);const x={lastSyncTime:n,syncStatus:a};return e.jsx(k.Provider,{value:x,children:r})}function ue(){const r=t.useContext(k);if(r===void 0)throw new Error("useSync must be used within a SyncProvider");return r}function me({children:r}){const{user:s,loading:n}=_();return g?n?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-midnight-900 via-midnight-800 to-midnight-900 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 rounded-2xl bg-gradient-to-br from-teal-400 to-teal-600 mb-6 animate-pulse",children:e.jsx(N,{className:"w-10 h-10 text-white"})}),e.jsx("h2",{className:"text-xl font-display font-bold text-white mb-2",children:"Loading..."}),e.jsx("p",{className:"text-midnight-400",children:"Please wait"})]})}):s?e.jsx(e.Fragment,{children:r}):e.jsx(Q,{to:"/login",replace:!0}):e.jsx(e.Fragment,{children:r})}const xe=[{path:"/",label:"Dashboard",icon:Z},{path:"/invoices",label:"Invoices",icon:G},{path:"/products",label:"Products",icon:K},{path:"/customers",label:"Customers",icon:H},{path:"/settings",label:"Settings",icon:ee}];function he({children:r}){const[s,n]=t.useState(!1),[o,a]=t.useState(!1),i=J(),x=X(),{user:p,signOut:v}=_(),{syncStatus:j}=ue(),f=l=>l==="/"?i.pathname==="/":i.pathname.startsWith(l),b=async()=>{await v(),x("/login")};return e.jsxs("div",{className:"min-h-screen flex",children:[s&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:()=>n(!1)}),e.jsx("aside",{className:`fixed lg:static inset-y-0 left-0 z-50 w-72 transform transition-transform duration-300 ease-in-out lg:transform-none ${s?"translate-x-0":"-translate-x-full lg:translate-x-0"}`,children:e.jsxs("div",{className:"h-full flex flex-col glass rounded-r-2xl lg:rounded-2xl m-0 lg:m-4",children:[e.jsx("div",{className:"p-6 border-b border-white/10",children:e.jsxs(w,{to:"/",className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-teal-400 to-teal-600 flex items-center justify-center shadow-glow",children:e.jsx(N,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-display font-bold text-white",children:"Businezz"}),e.jsx("p",{className:"text-xs text-midnight-400",children:"Smart Billing"})]})]})}),e.jsx("div",{className:"p-4",children:e.jsxs(w,{to:"/invoices/new",className:"flex items-center justify-center gap-2 w-full btn-primary py-3",onClick:()=>n(!1),children:[e.jsx(W,{className:"w-5 h-5"}),e.jsx("span",{children:"New Invoice"})]})}),e.jsx("nav",{className:"flex-1 px-4 py-2 space-y-1 overflow-y-auto",children:xe.map(l=>{const c=l.icon,u=f(l.path);return e.jsxs(w,{to:l.path,onClick:()=>n(!1),className:`flex items-center gap-3 px-4 py-3 rounded-xl transition-all duration-200 ${u?"bg-teal-500/20 text-teal-400":"text-midnight-300 hover:bg-white/5 hover:text-white"}`,children:[e.jsx(c,{className:`w-5 h-5 ${u?"text-teal-400":""}`}),e.jsx("span",{className:"font-medium",children:l.label}),u&&e.jsx("div",{className:"ml-auto w-1.5 h-1.5 rounded-full bg-teal-400"})]},l.path)})}),e.jsx("div",{className:"p-4 border-t border-white/10",children:g&&p?e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"flex items-center gap-2 px-3 py-2 rounded-lg bg-midnight-800/50",children:j==="synced"?e.jsxs(e.Fragment,{children:[e.jsx(te,{className:"w-4 h-4 text-teal-400"}),e.jsx("span",{className:"text-xs text-teal-400",children:"Synced"})]}):j==="syncing"?e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"w-4 h-4 text-blue-400 animate-pulse"}),e.jsx("span",{className:"text-xs text-blue-400",children:"Syncing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"w-4 h-4 text-midnight-400"}),e.jsx("span",{className:"text-xs text-midnight-400",children:"Idle"})]})}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>a(!o),className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-white/5 transition-colors",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center",children:e.jsx(C,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{className:"flex-1 text-left overflow-hidden",children:[e.jsx("p",{className:"text-sm text-white font-medium truncate",children:p.email}),e.jsx("p",{className:"text-xs text-midnight-400",children:"Account"})]})]}),o&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>a(!1)}),e.jsx("div",{className:"absolute bottom-full left-0 right-0 mb-2 glass rounded-lg p-2 z-50 animate-fade-in",children:e.jsxs("button",{onClick:b,className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg text-coral-400 hover:bg-coral-500/10 transition-colors",children:[e.jsx(O,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Sign Out"})]})})]})]})]}):e.jsx("div",{className:"text-center",children:g?e.jsxs("div",{className:"space-y-2",children:[e.jsx(se,{className:"w-6 h-6 text-midnight-500 mx-auto"}),e.jsx("p",{className:"text-xs text-midnight-400",children:"Not signed in"})]}):e.jsx("p",{className:"text-xs text-midnight-400",children:"Made with ❤️ for small businesses"})})})]})}),e.jsxs("main",{className:"flex-1 flex flex-col min-h-screen lg:p-4",children:[e.jsxs("header",{className:"lg:hidden flex items-center justify-between p-4 glass safe-area-top sticky top-0 z-30",children:[e.jsxs(w,{to:"/",className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg bg-gradient-to-br from-teal-400 to-teal-600 flex items-center justify-center",children:e.jsx(N,{className:"w-5 h-5 text-white"})}),e.jsx("span",{className:"font-display font-bold text-white text-lg",children:"Businezz"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[g&&p&&e.jsxs("button",{onClick:()=>a(!o),className:"p-2 rounded-lg hover:bg-white/10 active:bg-white/20 transition-colors relative","aria-label":"User menu",children:[e.jsx(C,{className:"w-5 h-5 text-white"}),o&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>a(!1)}),e.jsxs("div",{className:"absolute top-full right-0 mt-2 glass rounded-lg p-2 z-50 animate-fade-in min-w-[200px]",children:[e.jsxs("div",{className:"px-3 py-2 border-b border-white/10 mb-2",children:[e.jsx("p",{className:"text-sm text-white font-medium truncate",children:p.email}),e.jsx("p",{className:"text-xs text-midnight-400",children:"Account"})]}),e.jsxs("button",{onClick:b,className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg text-coral-400 hover:bg-coral-500/10 transition-colors",children:[e.jsx(O,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Sign Out"})]})]})]})]}),e.jsx("button",{onClick:()=>n(!s),className:"p-3 -mr-1 rounded-lg hover:bg-white/10 active:bg-white/20 transition-colors","aria-label":"Toggle menu",children:s?e.jsx(ne,{className:"w-6 h-6 text-white"}):e.jsx(ae,{className:"w-6 h-6 text-white"})})]})]}),e.jsx("div",{className:"flex-1 p-3 sm:p-4 lg:p-0 safe-area-bottom",children:e.jsx("div",{className:"glass rounded-2xl min-h-full p-4 sm:p-6 lg:p-8 animate-fade-in",children:r})})]})]})}const pe=t.lazy(()=>h(()=>import("./Dashboard-CVwXYNEE.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),fe=t.lazy(()=>h(()=>import("./Invoices-BeKIbdQe.js"),__vite__mapDeps([8,1,2,3,9,6,4,5,7]))),R=t.lazy(()=>h(()=>import("./CreateInvoice-Cg_mgIwx.js"),__vite__mapDeps([10,1,2,3,4,5,6,7]))),ge=t.lazy(()=>h(()=>import("./ViewInvoice-Br8bLZaP.js"),__vite__mapDeps([11,1,2,3,9,6,4,5,7]))),je=t.lazy(()=>h(()=>import("./Products-Dapc0xUn.js"),__vite__mapDeps([12,1,2,3,4,5,6,7]))),be=t.lazy(()=>h(()=>import("./Customers-DQuEU88R.js"),__vite__mapDeps([13,1,2,3,4,5,6,7]))),we=t.lazy(()=>h(()=>import("./Settings-BNzqnVbE.js"),__vite__mapDeps([14,1,2,4,5,6,7]))),ve=t.lazy(()=>h(()=>import("./Login-C1Evzxj6.js"),__vite__mapDeps([15,1,2,6,7]))),Ne=t.lazy(()=>h(()=>import("./Signup-C3LZPl2e.js"),__vite__mapDeps([16,1,2,5,3,6,7]))),ye=t.lazy(()=>h(()=>import("./ForgotPassword-Hwfqentl.js"),__vite__mapDeps([17,1,2,6,7])));function L(){return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(re,{className:"w-8 h-8 text-teal-400 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-midnight-400",children:"Loading..."})]})})}function _e(){return e.jsx($,{children:e.jsx(ce,{children:e.jsx(de,{children:e.jsx(t.Suspense,{fallback:e.jsx(L,{}),children:e.jsxs(E,{children:[e.jsx(m,{path:"/login",element:e.jsx(ve,{})}),e.jsx(m,{path:"/signup",element:e.jsx(Ne,{})}),e.jsx(m,{path:"/forgot-password",element:e.jsx(ye,{})}),e.jsx(m,{path:"/*",element:e.jsx(me,{children:e.jsx(he,{children:e.jsx(t.Suspense,{fallback:e.jsx(L,{}),children:e.jsxs(E,{children:[e.jsx(m,{path:"/",element:e.jsx(pe,{})}),e.jsx(m,{path:"/invoices",element:e.jsx(fe,{})}),e.jsx(m,{path:"/invoices/new",element:e.jsx(R,{})}),e.jsx(m,{path:"/invoices/edit/:id",element:e.jsx(R,{})}),e.jsx(m,{path:"/invoices/view/:id",element:e.jsx(ge,{})}),e.jsx(m,{path:"/products",element:e.jsx(je,{})}),e.jsx(m,{path:"/customers",element:e.jsx(be,{})}),e.jsx(m,{path:"/settings",element:e.jsx(we,{})})]})})})})})]})})})})})}class Se extends t.Component{constructor(){super(...arguments);S(this,"state",{hasError:!1,error:null})}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,o){console.error("Uncaught error:",n,o)}render(){var n;return this.state.hasError?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-midnight-900 via-midnight-800 to-midnight-900 flex items-center justify-center p-4",children:e.jsxs("div",{className:"glass rounded-2xl p-8 max-w-md w-full text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-2xl bg-coral-500/20 mb-6",children:e.jsx(ie,{className:"w-8 h-8 text-coral-400"})}),e.jsx("h1",{className:"text-2xl font-display font-bold text-white mb-2",children:"Something went wrong"}),e.jsx("p",{className:"text-midnight-400 mb-6",children:((n=this.state.error)==null?void 0:n.message)||"An unexpected error occurred. Please try refreshing the page."}),e.jsxs("button",{onClick:()=>window.location.reload(),className:"btn-primary w-full flex items-center justify-center gap-2",children:[e.jsx(le,{className:"w-4 h-4"}),"Reload Application"]})]})}):this.props.children}}const Ee=new U({defaultOptions:{queries:{staleTime:5*60*1e3,gcTime:10*60*1e3,refetchOnWindowFocus:!0,refetchOnReconnect:!0,retry:1,retryDelay:1e3},mutations:{retry:1}}}),z=document.getElementById("root");if(!z)throw new Error("Failed to find root element");y.createRoot(z).render(e.jsx(q.StrictMode,{children:e.jsxs(V,{client:Ee,children:[e.jsx(Se,{children:e.jsx(_e,{})}),e.jsx(M,{initialIsOpen:!1})]})}));export{Le as T,_ as a,g as i,d as s,ue as u};
