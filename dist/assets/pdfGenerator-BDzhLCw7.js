import{v as G}from"./ui-libs-B_77BvNz.js";import{c as B,d as M,n as O}from"./helpers-C0Vzrg-0.js";const g=(n,o="Rs.")=>{const h=parseFloat(String(n))||0;return`${o==="â‚¹"?"Rs.":o} ${h.toFixed(2)}`},$=(n,o,h={})=>{const t=new G,l=t.internal.pageSize.getWidth(),T=t.internal.pageSize.getHeight(),a=15,v=l-2*a;let e=15;const m=B(n.items,n.taxRate,n.discount),d=o.currency||"Rs.";t.setFontSize(14),t.setFont("helvetica","bold"),t.text("Tax Invoice",l/2,e,{align:"center"}),e+=10,t.setLineWidth(.5),t.line(a,e,l-a,e),e+=8;const A=e;if(h.showLogo&&o.logo)try{console.log("Adding logo to PDF:",{showLogo:h.showLogo,hasLogo:!!o.logo}),t.addImage(o.logo,"PNG",a,e,20,20)}catch(r){console.error("Error adding logo to PDF:",r)}else console.log("Logo not added to PDF:",{showLogo:h.showLogo,hasLogo:!!o.logo});t.setFontSize(12),t.setFont("helvetica","bold");const b=e+5;if(t.text(o.name||"Business Name",l-a,b,{align:"right"}),e+=8,t.setFontSize(8),t.setFont("helvetica","normal"),o.address&&(t.text(o.address,l-a,e,{align:"right"}),e+=4),o.city||o.state){const r=`${o.city||""}${o.city&&o.state?", ":""}${o.state||""} ${o.pincode||""}`.trim();t.text(r,l-a,e,{align:"right"}),e+=4}o.phone&&(t.text(`Phone no.: ${o.phone}`,l-a,e,{align:"right"}),e+=4),o.email&&(t.text(`Email: ${o.email}`,l-a,e,{align:"right"}),e+=4),o.taxId&&(t.text(`GSTIN: ${o.taxId}, State: ${o.state||"09-Uttar Pradesh"}`,l-a,e,{align:"right"}),e+=4),e=Math.max(e,A+30),e+=5,t.setLineWidth(.5),t.line(a,e,l-a,e),e+=8;const i=a,c=l/2+5,p=e;t.setFont("helvetica","bold"),t.setFontSize(9),t.text("Bill To",i,p),t.setFont("helvetica","normal"),t.setFontSize(8);let u=p+5;if(t.text(n.customerName||"Customer",i,u),u+=4,n.customerAddress){const r=t.splitTextToSize(n.customerAddress,l/2-a-10);t.text(r,i,u),u+=r.length*4}t.text(`State: ${o.state||"09-Uttar Pradesh"}`,i,u),t.setFont("helvetica","bold"),t.setFontSize(9),t.text("Invoice Details",c,p),t.setFont("helvetica","normal"),t.setFontSize(8);let f=p+5;t.text(`Invoice No.: ${n.invoiceNumber}`,c,f),f+=4,t.text(`Date: ${M(n.date)}`,c,f),f+=4,t.text(`Place of Supply: ${o.state||"09-Uttar Pradesh"}`,c,f),e=Math.max(u,f)+8,t.setLineWidth(.5),t.line(a,e,l-a,e),e+=5;const R=n.items.map((r,N)=>{const L=r.quantity*r.price,D=L*n.discount/100,y=L-D,I=y*n.taxRate/100,U=y+I;return[(N+1).toString(),r.name,r.quantity.toString(),r.unit||"PCS",g(r.price,d),`${g(D,d)}
(${n.discount}%)`,g(y,d),`${g(I,d)}
(${n.taxRate.toFixed(1)}%)`,g(U,d)]});t.autoTable({startY:e,head:[["#","Item name","Quantity","Unit","Price/Unit","Discount","Taxable amount","GST","Amount"]],body:R,margin:{left:a,right:a},tableWidth:v,styles:{fontSize:7,cellPadding:2,lineColor:[0,0,0],lineWidth:.1,textColor:[0,0,0]},headStyles:{fillColor:[255,255,255],textColor:[0,0,0],fontStyle:"bold",lineWidth:.3},bodyStyles:{fillColor:[255,255,255]},columnStyles:{0:{cellWidth:10,halign:"center"},1:{cellWidth:"auto"},2:{cellWidth:15,halign:"center"},3:{cellWidth:12,halign:"center"},4:{cellWidth:20,halign:"right"},5:{cellWidth:20,halign:"right"},6:{cellWidth:22,halign:"right"},7:{cellWidth:20,halign:"right"},8:{cellWidth:22,halign:"right"}}}),e=t.lastAutoTable.finalY+5,t.setLineWidth(.5),t.line(a,e,l-a,e),e+=8;const S=e;t.setFont("helvetica","bold"),t.setFontSize(8),t.text("Tax type",i,S),t.text("Taxable amount",i+35,S,{align:"right"}),t.text("Rate",i+50,S,{align:"center"}),t.text("Tax amount",i+70,S,{align:"right"}),t.setFont("helvetica","normal"),t.setFontSize(7);let s=S+5;const z=n.taxRate/2,W=m.taxAmount/2;t.text("SGST",i,s),t.text(g(m.taxableAmount,d),i+35,s,{align:"right"}),t.text(`${z.toFixed(1)}%`,i+50,s,{align:"center"}),t.text(g(W,d),i+70,s,{align:"right"}),s+=5,t.text("CGST",i,s),t.text(g(m.taxableAmount,d),i+35,s,{align:"right"}),t.text(`${z.toFixed(1)}%`,i+50,s,{align:"center"}),t.text(g(W,d),i+70,s,{align:"right"}),t.setFont("helvetica","bold"),t.setFontSize(8),t.text("Amounts",c,S),t.setFont("helvetica","normal"),t.setFontSize(7);let x=S+5;t.text("Sub Total",c,x),t.text(g(m.taxableAmount,d),l-a,x,{align:"right"}),x+=5,t.text("Round off",c,x);const Y=`${m.roundOff>=0?"":"- "}${g(Math.abs(m.roundOff),d)}`;t.text(Y,l-a,x,{align:"right"}),x+=5,t.setFont("helvetica","bold"),t.setFontSize(8),t.text("Total",c,x),t.text(g(m.total,d),l-a,x,{align:"right"}),e=Math.max(s,x)+8,t.setLineWidth(.5),t.line(a,e,l-a,e),e+=8;const w=e;t.setFont("helvetica","bold"),t.setFontSize(8),t.text("Invoice Amount In Words",i,e),e+=5,t.setFont("helvetica","normal"),t.setFontSize(7);const C=`${O(Math.floor(m.total))} Rupees only`,P=t.splitTextToSize(C,l/2-a-10);if(t.text(P,i,e),e+=P.length*4+5,t.setFont("helvetica","bold"),t.setFontSize(8),t.text("Terms and conditions",i,e),e+=5,t.setFont("helvetica","normal"),t.setFontSize(7),n.notes){e+=2;const r=t.splitTextToSize(n.notes,l/2-a-10);t.text(r,i,e)}let F=w;if(t.setFont("helvetica","normal"),t.setFontSize(7),t.text(`For: ${o.name||"Your Business Name"}`,c,F),F=T-40,o.signature)try{console.log("Adding signature to PDF:",{hasSignature:!!o.signature}),t.addImage(o.signature,"PNG",c+15,F-10,30,15),F+=10}catch(r){console.error("Failed to add signature to PDF:",r)}else console.log("Signature not added to PDF:",{hasSignature:!!o.signature});return t.setLineWidth(.3),t.line(c+10,F,c+50,F),F+=4,t.setFont("helvetica","bold"),t.text("Authorized Signatory",c+30,F,{align:"center"}),t},H=(n,o,h)=>{$(n,o,h).save(`${n.invoiceNumber}.pdf`)},X=(n,o,h)=>$(n,o,h).output("blob"),j=(n,o,h)=>{const l=$(n,o,h).output("blob"),T=URL.createObjectURL(l);window.open(T,"_blank")};export{H as d,X as g,j as o};
